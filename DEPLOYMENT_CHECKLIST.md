# 部署检查清单

## 📋 部署前检查

### 代码质量检查
- [x] 代码编译成功（npm run build）
- [x] 没有TypeScript错误
- [x] 没有ESLint警告
- [x] 代码格式规范

### 功能验证
- [x] 激活码导出功能实现
- [x] 激活码筛选功能实现
- [x] 激活码分页功能实现
- [x] 提现申请导出功能实现
- [x] 提现申请筛选功能实现
- [x] 提现申请分页功能实现
- [x] 数据统计时间快速选项实现
- [x] 数据统计首行数据优化实现

### 依赖检查
- [x] xlsx库已安装
- [x] 没有新增安全漏洞
- [x] 所有依赖版本兼容

---

## 🚀 部署步骤

### 1. 本地验证
```bash
# 清理构建缓存
rm -rf .next

# 重新构建
npm run build

# 启动开发服务器
npm run dev

# 访问管理后台进行功能测试
# http://localhost:3002/admin
```

### 2. Git提交
```bash
# 查看修改文件
git status

# 添加所有修改
git add .

# 提交代码
git commit -m "feat: 优化后台管理系统

- 激活码列表添加导出Excel功能
- 激活码列表添加时间筛选和分页
- 提现申请添加导出Excel功能
- 提现申请添加时间筛选和分页
- 数据统计添加今天/昨天快速选项
- 数据统计首行改为显示今日新增数据"

# 推送到远程
git push origin main
```

### 3. Vercel部署
```bash
# 使用Vercel CLI部署
vercel --prod

# 或者通过GitHub自动部署
# 推送到main分支后自动触发部署
```

### 4. 部署后验证
- [ ] 访问生产环境管理后台
- [ ] 测试激活码导出功能
- [ ] 测试提现申请导出功能
- [ ] 测试数据统计时间筛选
- [ ] 检查浏览器控制台是否有错误
- [ ] 检查网络请求是否正常

---

## 📊 修改文件清单

### 修改的文件
1. **app/admin/components/ActivationManagement.tsx**
   - 添加xlsx导入
   - 添加筛选和分页状态
   - 添加导出函数
   - 更新UI添加筛选和分页控件

2. **app/admin/components/Analytics.tsx**
   - 添加"today"和"yesterday"时间选项
   - 修改首行卡片显示今日新增数据
   - 更新卡片样式（红色背景）

3. **app/api/admin/analytics-supabase/route.ts**
   - 添加"today"和"yesterday"时间段支持

### 新增文件
1. **package.json** (修改)
   - 添加xlsx依赖

---

## 🔄 回滚计划

如果部署后发现问题，可以按以下步骤回滚：

```bash
# 查看提交历史
git log --oneline

# 回滚到上一个版本
git revert HEAD

# 或者直接重置
git reset --hard HEAD~1

# 推送回滚
git push origin main --force
```

---

## 📞 故障排查

### 问题1: 导出Excel文件为空
**解决方案**:
- 检查是否有激活码或提现申请数据
- 检查浏览器控制台是否有错误
- 检查xlsx库是否正确导入

### 问题2: 时间筛选不生效
**解决方案**:
- 检查日期格式是否正确
- 检查数据库中是否有该时间范围的数据
- 清除浏览器缓存重试

### 问题3: 分页显示不正确
**解决方案**:
- 检查分页逻辑是否正确
- 检查数据总数是否正确计算
- 检查每页显示数量是否正确设置

---

## 📈 性能指标

### 预期性能
- 导出Excel：< 2秒
- 时间筛选：< 500ms
- 分页切换：< 300ms
- 页面加载：< 3秒

### 监控指标
- 首屏加载时间
- 导出功能响应时间
- 筛选功能响应时间
- 错误率

---

## ✅ 最终检查

部署前最后确认：
- [ ] 所有测试用例通过
- [ ] 没有已知的bug
- [ ] 性能指标达标
- [ ] 文档已更新
- [ ] 团队成员已通知

---

**准备部署**: 2025-10-28
**部署人员**: [待填写]
**部署时间**: [待填写]
**部署结果**: [待填写]

